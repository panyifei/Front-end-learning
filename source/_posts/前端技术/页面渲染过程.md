---
layout: default
title: \{#\{ site.name \}#\}
---
# 页面渲染
有篇神文：http://www.html5rocks.com/zh/tutorials/internals/howbrowserswork/

大家都知道的，敲一个地址，会先从DNS解析成IP地址，然后请求IP，得到HTML文档，然后就开始加载各个css，js，img的资源。

## Html呈现过程
呈现引擎会力求尽快地将内容显现在屏幕上，不必等整个HTML文档解析完毕。就会开始构建呈现树和布局。

注意是开始解析到body标签才会开始渲染文档。

高版本浏览器现在允许并行下载Javascript文件了，但是js任然会阻塞其他资源，比如图片。而且页面仍然要等JS都下载执行完才能继续。

浏览器的解析文档有一定的纠错，比如将块级元素放在行内元素中，比如有时</br>也可以被解析成功。是因为浏览器本身的纠错能力。

### CSS渲染
浏览器在所有的stylesheets加载完成之后才会开始渲染整个页面吗，答案是并不会，这在各个浏览器的实现都是不同的，都有各自的策略。

使用@import等于就是把<link>标签放在页面的底部，从优化上看，应该避免使用。

浏览器会构成DOM树以及渲染树(隐藏的DOM没有对应的渲染树节点)，然后就会进行重排以及重绘。

### JS阻塞
JS直接写在html中是会阻止html的解析的，如果是外部的js，那么文档解析的过程会停止，直到拿取到资源之后才会再继续。

我们将脚本标注为defer，就会等待文档解析结束才会执行。

Html5增加了一个选项，可以将脚本标记为异步，由其他线程解析和执行。

FF在样式表加载和解析时，会禁止所有脚本，而webkit只有在脚本访问的样式属性可能被影响的时候，才会禁止脚本。
